<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ãƒãƒ¯ã‚¤æ—…ç¨‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ 2026 (Final v9)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap"
        rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #fdfcf8;
            color: #44403c;
            -webkit-font-smoothing: antialiased;
        }



        .nav-item.active {
            border-bottom: 3px solid #0d9488;
            color: #0f766e;
            font-weight: 700;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .chart-wrapper {
            position: relative;
            width: 100%;
            margin: 0 auto;
            height: 280px;
            max-height: 400px;
        }

        html {
            scroll-behavior: smooth;
        }

        /* Safe Area Support */
        .mb-safe {
            margin-bottom: env(safe-area-inset-bottom, 20px);
        }

        .pb-safe {
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }

        .pt-safe {
            padding-top: env(safe-area-inset-top, 20px);
        }
    </style>
</head>

<body class="flex flex-col min-h-screen bg-stone-50">



    <!-- Navigation -->
    <nav class="bg-white/95 backdrop-blur-sm shadow-sm sticky top-0 z-50 border-b border-stone-100 pt-[env(safe-area-inset-top)]"
        id="main-nav">
        <div class="max-w-6xl mx-auto">
            <div class="flex flex-col">
                <div
                    class="flex items-center justify-center h-12 border-b border-stone-50 md:border-none md:justify-start md:h-16 md:px-4">
                    <span class="text-xl mr-2">ğŸŒº</span>
                    <span class="font-bold text-lg tracking-wide text-teal-800">Hawaii 2026 (Final v9)</span>
                </div>
                <div class="flex overflow-x-auto no-scrollbar px-2 md:px-4">
                    <button onclick="app.navigate('dashboard')" id="nav-dashboard"
                        class="nav-item active flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap">æ¦‚è¦</button>
                    <button onclick="app.navigate('itinerary')" id="nav-itinerary"
                        class="nav-item flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap">æ—…ç¨‹è©³ç´°</button>
                    <button onclick="app.navigate('restaurants')" id="nav-restaurants"
                        class="nav-item flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap">ã‚°ãƒ«ãƒ¡</button>
                    <button onclick="app.navigate('spots')" id="nav-spots"
                        class="nav-item flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap">ã‚¹ãƒãƒƒãƒˆ</button>
                    <button onclick="app.navigate('packing')" id="nav-packing"
                        class="nav-item flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap">æŒã¡ç‰©</button>
                    <button onclick="app.navigate('memo')" id="nav-memo"
                        class="nav-item flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap">ãƒ¡ãƒ¢</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="app-content" class="flex-grow max-w-6xl mx-auto px-4 py-6 w-full pb-20"></main>

    <!-- Footer -->
    <footer class="bg-stone-100 mt-auto py-8 border-t border-stone-200 mb-safe" id="main-footer">
        <div class="max-w-6xl mx-auto px-4 text-center text-stone-500 text-sm">
            <p class="font-medium text-teal-700">Mahalo! ğŸŒ´</p>
        </div>
    </footer>

    <script>
        console.log('Hawaii Trip Script Loaded v9 (No Auth)');

        const tripData = {
            meta: {
                dates: "2026/01/06(ç«) ã€œ 01/15(æœ¨)",
                nights: 8,
                hotel: "Sheraton Princess Kaiulani",
                hotelMap: "https://www.google.com/maps/search/?api=1&query=Sheraton+Princess+Kaiulani+Waikiki",
                theme: "ãƒˆãƒ­ãƒªãƒ¼æ´»ç”¨ & æ™¯è‰²ã‚’æ¥½ã—ã‚€ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ã€‚",
                flights: {
                    outbound: {
                        date: "1/6(ç«)",
                        legs: [
                            { flight: "JL221", from: "ç¾½ç”°", to: "é–¢è¥¿", dep: "07:00", arr: "08:25", class: "æ™®é€šå¸­" },
                            { flight: "JL792", from: "é–¢è¥¿", to: "ãƒ›ãƒãƒ«ãƒ«", dep: "22:10", arr: "10:15", class: "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¨ã‚³ãƒãƒŸãƒ¼" }
                        ]
                    },
                    return: {
                        date: "1/15(æœ¨)",
                        legs: [
                            { flight: "JL791", from: "ãƒ›ãƒãƒ«ãƒ«", to: "é–¢è¥¿", dep: "10:55", arr: "15:55+1", class: "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¨ã‚³ãƒãƒŸãƒ¼" },
                            { flight: "JL228", from: "é–¢è¥¿", to: "ç¾½ç”°", dep: "21:05", arr: "22:15", class: "æ™®é€šå¸­" }
                        ]
                    }
                }
            },
            days: [
                {
                    id: 0, date: "1/6(ç«)", title: "USJ & é–¢ç©ºå‡ºç™º", icon: "ğŸ¢",
                    summary: "é–¢ç©ºåˆ°ç€å¾ŒUSJã§éŠã³ã€å¤œä¾¿ã§ãƒ›ãƒãƒ«ãƒ«ã¸ã€‚",
                    budgetEst: 150,
                    timeline: [
                        { time: "08:25", type: "transport", title: "é–¢ç©ºåˆ°ç€ (JL221)", desc: "ç¾½ç”°ã‹ã‚‰ã®å›½å†…ç·šã§é–¢è¥¿ç©ºæ¸¯ç¬¬1ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ç€ã€‚", map: null },
                        { time: "09:30", type: "bus", title: "ãƒªãƒ ã‚¸ãƒ³ãƒã‚¹ç™º", desc: "é–¢ç©ºT1 â†’ USJ\né‹è³ƒ: å¤§äºº1,800å††\næ‰€è¦æ™‚é–“: ç´„50åˆ†", map: null },
                        { time: "10:20", type: "activity", title: "USJåˆ°ç€", desc: "ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ãƒ»ã‚¹ã‚¿ã‚¸ã‚ªãƒ»ã‚¸ãƒ£ãƒ‘ãƒ³åˆ°ç€ï¼", map: "https://www.google.com/maps/search/?api=1&query=Universal+Studios+Japan" },
                        { time: "10:30", type: "activity", title: "USJã§éŠã¶", desc: "ç´„7æ™‚é–“æ¥½ã—ã‚€ï¼\nè·ç‰©ã¯ãƒ‘ãƒ¼ã‚¯å†…ã‚³ã‚¤ãƒ³ãƒ­ãƒƒã‚«ãƒ¼ã¸ã€‚", map: null },
                        { time: "18:00", type: "bus", title: "ãƒªãƒ ã‚¸ãƒ³ãƒã‚¹ç™º", desc: "USJ â†’ é–¢ç©ºT1\næ‰€è¦æ™‚é–“: ç´„70åˆ†", map: null },
                        { time: "19:10", type: "transport", title: "é–¢ç©ºåˆ°ç€", desc: "ç¬¬1ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ç€ã€‚å›½éš›ç·šã¸ç§»å‹•ã€‚", map: null },
                        { time: "19:30", type: "relax", title: "ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ©ã‚¦ãƒ³ã‚¸", desc: "å›½éš›ç·šãƒ©ã‚¦ãƒ³ã‚¸ã§ã‚·ãƒ£ãƒ¯ãƒ¼ï¼†å¤•é£Ÿã€‚\nå‡ºç™ºã¾ã§ã‚†ã£ãã‚Šã€‚", map: null },
                        { time: "22:10", type: "transport", title: "JL792 å‡ºç™º", desc: "é–¢ç©º â†’ ãƒ›ãƒãƒ«ãƒ«\nãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¨ã‚³ãƒãƒŸãƒ¼", map: null }
                    ]
                },
                {
                    id: 1, date: "1/6(ç«)", title: "åˆ°ç€ & ã‚¤ã‚¿ãƒªã‚¢ãƒ³", icon: "ğŸ›¬",
                    summary: "åˆ°ç€æ—¥ã¯ã‚†ã£ãã‚Šã€‚å¤œã¯ã‚¤ã‚¿ãƒªã‚¢ãƒ³ã§ä¹¾æ¯ã€‚",
                    budgetEst: 130,
                    timeline: [
                        { time: "10:15", type: "transport", title: "ãƒ›ãƒãƒ«ãƒ«åˆ°ç€ (JL792)", desc: "ãƒ€ãƒ‹ã‚¨ãƒ«ãƒ»Kãƒ»ã‚¤ãƒã‚¦ã‚¨å›½éš›ç©ºæ¸¯ç€ã€‚\nå…¥å›½å¯©æŸ»ãƒ»è·ç‰©å—å–ã€‚", map: null },
                        { time: "11:00", type: "transport", title: "Uber/Lyft", desc: "ç©ºæ¸¯ â†’ ãƒ¯ã‚¤ã‚­ã‚­ï¼ˆç´„25åˆ†ï¼‰\nğŸ’° $25-40ï¼ˆ2åï¼‰\nğŸ’¡ ä¸¡ã‚¢ãƒ—ãƒªã§æ¯”è¼ƒã—ã¦å®‰ã„æ–¹ã‚’ï¼", map: null },
                        { time: "11:30", type: "hotel", title: "è·ç‰©é ã‘", desc: "ã‚·ã‚§ãƒ©ãƒˆãƒ³ã¸ã€‚", map: null },
                        { time: "12:00", type: "walk", title: "å¾’æ­© (10åˆ†)", desc: "ãƒ¯ã‚¤ã‚­ã‚­ãƒ“ãƒ¼ãƒã‚’æ•£ç­–ã€‚", map: null },
                        { time: "12:30", type: "food", title: "Tropical Tribe", desc: "ã€ãƒ©ãƒ³ãƒã€‘ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒªãƒ¼ãƒ™ã‚¤åœ°ä¸‹ã€‚æ¿ƒåšã‚¢ã‚µã‚¤ãƒ¼ãƒœã‚¦ãƒ«ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Tropical+Tribe+Waikiki" },
                        { time: "15:00", type: "hotel", title: "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", desc: "ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’æµ´ã³ã¦ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã€‚", map: null },
                        { time: "18:30", type: "walk", title: "å¾’æ­© (15åˆ†)", desc: "ã‚«ãƒ©ã‚«ã‚¦ã‚¢é€šã‚Šã‚’æµ·æ²¿ã„ã«æ•£æ­©ã€‚", map: null },
                        { time: "19:00", type: "food", title: "Arancino di Mare", desc: "ã€ãƒ‡ã‚£ãƒŠãƒ¼ã€‘ã€äºˆç´„ç¢ºå®šã€‘ãƒãƒªã‚ªãƒƒãƒˆ1Fã€‚ã‚¦ãƒ‹ãƒ‘ã‚¹ã‚¿ã€‚\nğŸ“ 808-931-6273\nğŸ‘” ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ï¼ˆãƒ“ãƒ¼ãƒã‚¦ã‚§ã‚¢ä¸å¯ï¼‰", map: "https://www.google.com/maps/search/?api=1&query=Arancino+di+Mare", reserved: true }
                    ]
                },
                {
                    id: 2, date: "1/7(æ°´)", title: "ãƒãƒ¼ã‚¹ã‚·ãƒ§ã‚¢ & ã‚³ã‚¹ãƒˆã‚³", icon: "ğŸš—",
                    summary: "ã€ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼ã€‘1æ—¥ãƒ‰ãƒ©ã‚¤ãƒ–ã€‚å¸°ã‚Šã«ã‚³ã‚¹ãƒˆã‚³ã§è²·ã„å‡ºã—ã€‚",
                    budgetEst: 200,
                    timeline: [
                        { time: "09:00", type: "transport", title: "ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼å‡ºç™º", desc: "ãƒãƒ¬ã‚¤ãƒ¯æ–¹é¢ã¸ã€‚", map: null },
                        { time: "11:30", type: "photo", title: "Laniakea Beach", desc: "äº€ã‚¦ã‚©ãƒƒãƒãƒ³ã‚°ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Laniakea+Beach" },
                        { time: "12:30", type: "food", title: "Giovanni's Shrimp", desc: "ã€ãƒ©ãƒ³ãƒã€‘ã‚¬ãƒ¼ãƒªãƒƒã‚¯ã‚·ãƒ¥ãƒªãƒ³ãƒ—ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Giovanni's+Shrimp+Truck+Haleiwa" },
                        { time: "15:00", type: "shop", title: "Costco (Iwilei)", desc: "å¸°ã‚Šé“ã«ã‚³ã‚¹ãƒˆã‚³ã¸ã€‚ãŠæ°´ãƒ»ãŠè“å­ãƒ»æ—¥ç”¨å“ã‚’ã¾ã¨ã‚è²·ã„ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Costco+Iwilei+Honolulu" },
                        { time: "17:00", type: "transport", title: "ãƒ¯ã‚¤ã‚­ã‚­æˆ»ã‚Š", desc: "è»Šè¿”å´ã€‚", map: null },
                        { time: "19:00", type: "food", title: "RumFire", desc: "ã€ãƒ‡ã‚£ãƒŠãƒ¼ã€‘ã‚·ã‚§ãƒ©ãƒˆãƒ³å†…ãƒ—ãƒ¼ãƒ«ã‚µã‚¤ãƒ‰ã€‚", map: "https://www.google.com/maps/search/?api=1&query=RumFire+Waikiki" }
                    ]
                },
                {
                    id: 3, date: "1/8(æœ¨)", title: "DH & ã‚°ãƒ«ãƒ¡æ•£æ­©", icon: "â›°ï¸",
                    summary: "TheBusã§ç§»å‹•ã—ã€æœæ—¥ãƒã‚¤ã‚­ãƒ³ã‚°ã€‚",
                    budgetEst: 100,
                    timeline: [
                        { time: "07:43", type: "bus", title: "TheBus (2ç•ª/2L)", desc: "ã€ä¹—ã‚Šå ´ã€‘Kuhio Ave + Kaiulani Ave\nã€æ™‚åˆ»è¡¨ã€‘\nâ€¢ 7:43ç™ºâ†’7:57ç€ (14åˆ†)\nâ€¢ 8:16ç™ºâ†’8:30ç€ (14åˆ†)\nâ€¢ 8:21ç™ºâ†’8:35ç€ (14åˆ†)\nã€æ–™é‡‘ã€‘$3.00/äºº\nã€é™è»Šã€‘Diamond Head Rd + Opp 18th Ave", map: "https://www.google.com/maps/search/?api=1&query=Kuhio+Ave+Kaiulani+Ave+Waikiki" },
                        { time: "08:00", type: "activity", title: "Diamond Head", desc: "ã€äºˆç´„ç¢ºå®šã€‘8:00ã€œ9:00 å…¥å ´ã€‚\nQRã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã—ã¦å…¥å ´ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Diamond+Head+State+Monument", ticket: "./images/diamond_head_qr.png" },
                        { time: "09:00", type: "walk", title: "å¾’æ­© (25åˆ†)", desc: "ä¸˜ã‚’ä¸‹ã‚Šã¦ãƒ¢ãƒ³ã‚µãƒ©ãƒƒãƒˆé€šã‚Šã¸ã€‚çµ¶æ™¯æ•£æ­©ã€‚", map: null },
                        { time: "09:30", type: "food", title: "Bogart's Cafe", desc: "ã€ãƒ–ãƒ©ãƒ³ãƒã€‘ãƒ•ãƒ©ã‚¤ãƒ‰ãƒ©ã‚¤ã‚¹ã§ã‚¨ãƒãƒ«ã‚®ãƒ¼è£œçµ¦ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Bogart's+Cafe+Honolulu" },
                        { time: "10:30", type: "food", title: "Leonard's Bakery", desc: "ã€ãŠã‚„ã¤ã€‘æšã’ãŸã¦ãƒãƒ©ã‚µãƒ€(å¾’æ­©15åˆ†ç§»å‹•)ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Leonard's+Bakery" },
                        { time: "11:00", type: "walk", title: "å¾’æ­© (45åˆ†)", desc: "ãƒ¯ã‚¤ã‚­ã‚­ã¾ã§è…¹ã”ãªã—ãƒ­ãƒ³ã‚°ã‚¦ã‚©ãƒ¼ã‚¯(ç´„3.5km)ã€‚", map: null },
                        { time: "PM", type: "relax", title: "ãƒ•ãƒªãƒ¼ã‚¿ã‚¤ãƒ ", desc: "ãƒ—ãƒ¼ãƒ«ã‚„ãƒ“ãƒ¼ãƒã§ãŠæ˜¼å¯ã€‚", map: null },
                        { time: "17:30", type: "walk", title: "å¾’æ­© (10åˆ†)", desc: "ãƒã‚¤ã‚¢ãƒƒãƒˆæ–¹é¢ã¸ã€‚", map: null },
                        { time: "18:00", type: "food", title: "Kirin Restaurant", desc: "ã€ãƒ‡ã‚£ãƒŠãƒ¼ã€‘ã€äºˆç´„ç¢ºå®šã€‘ä¸­è¯ã®ååº—ã€‚\nğŸ“ 808-942-1888\nğŸ‘” ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«", map: "https://www.google.com/maps/search/?api=1&query=Kirin+Restaurant+Waikiki", reserved: true }
                    ]
                },
                {
                    id: 4, date: "1/9(é‡‘)", title: "ã‚¢ãƒ©ãƒ¢ã‚¢ãƒŠ(JCB)", icon: "ğŸ›ï¸",
                    summary: "ãƒ”ãƒ³ã‚¯ãƒ©ã‚¤ãƒ³ã‚’æ´»ç”¨ã—ã¦ã‚¢ãƒ©ãƒ¢ã‚¢ãƒŠã¸ã€‚",
                    budgetEst: 200,
                    timeline: [
                        { time: "10:00", type: "trolley", title: "ãƒ”ãƒ³ã‚¯ãƒ©ã‚¤ãƒ³ (JCBç„¡æ–™)", desc: "ãƒ­ã‚¤ãƒ¤ãƒ«ãƒãƒ¯ã‚¤ã‚¢ãƒ³Cã€œã‚¢ãƒ©ãƒ¢ã‚¢ãƒŠ(ç´„20åˆ†)ã€‚", map: null },
                        { time: "AM", type: "shop", title: "Ala Moana Center", desc: "æ—¥æœ¬æœªä¸Šé™¸ãƒ–ãƒ©ãƒ³ãƒ‰ç­‰ã‚’ãƒã‚§ãƒƒã‚¯ã€‚", map: null },
                        { time: "13:00", type: "food", title: "Foodland Farms", desc: "ã€ãƒ©ãƒ³ãƒã€‘ãƒã‚­ä¸¼ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Foodland+Farms+Ala+Moana" },
                        { time: "17:30", type: "walk", title: "å¾’æ­© (15åˆ†)", desc: "ã‚«ã‚«ã‚¢ã‚³æ–¹é¢ã¸å¤•æš®ã‚Œæ•£æ­©ã€‚", map: null },
                        { time: "Night", type: "relax", title: "ãƒ•ãƒªãƒ¼ãƒ‡ã‚£ãƒŠãƒ¼", desc: "ãŠè…¹ã®ç©ºãå…·åˆã«åˆã‚ã›ã¦ã€‚", map: null },
                        { time: "20:30", type: "transport", title: "Uber/ã‚¿ã‚¯ã‚·ãƒ¼", desc: "å¤œé…ã„ã®ã§å¸°ã‚Šã¯è»Šæ¨å¥¨ã€‚", map: null }
                    ]
                },
                {
                    id: 5, date: "1/10(åœŸ)", title: "æœå¸‚ & å…¬åœ’æ•£æ­©", icon: "ğŸ¥",
                    summary: "å…¬åœ’ã‚’æŠœã‘ã¦KCCæœå¸‚ã¾ã§ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ã€‚",
                    budgetEst: 50,
                    timeline: [
                        { time: "07:30", type: "walk", title: "å¾’æ­© (40åˆ†)", desc: "ã‚«ãƒ”ã‚ªãƒ©ãƒ‹å…¬åœ’ã€œæµ·æ²¿ã„ã‚’çˆ½å¿«ã«ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ã€‚", map: null },
                        { time: "08:30", type: "shop", title: "KCC Farmers Market", desc: "æœé£Ÿèª¿é”ã¨ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã€‚", map: "https://www.google.com/maps/search/?api=1&query=KCC+Farmers+Market" },
                        { time: "10:30", type: "bus", title: "TheBus / ãƒˆãƒ­ãƒªãƒ¼", desc: "å¸°ã‚Šã¯è·ç‰©ã‚‚ã‚ã‚‹ã®ã§ãƒã‚¹ã‹ãƒˆãƒ­ãƒªãƒ¼ã§ã€‚", map: null },
                        { time: "PM", type: "relax", title: "ãƒ•ãƒªãƒ¼ / æµ·ãƒãƒ«", desc: "ãƒ›ãƒ†ãƒ«ãƒ©ãƒŠã‚¤ã§èª­æ›¸ãªã©ã€‚", map: null },
                        { time: "18:00", type: "walk", title: "å¾’æ­© (5åˆ†)", desc: "ã‚¯ãƒ’ã‚ªé€šã‚Šã¸ã€‚", map: null },
                        { time: "18:10", type: "food", title: "Maguro Spot", desc: "ã€ãƒ‡ã‚£ãƒŠãƒ¼ã€‘ãƒã‚­ã‚’ãƒ†ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆã€‚", map: "https://www.google.com/maps/search/?api=1&query=Maguro+Spot+Waikiki" }
                    ]
                },
                {
                    id: 6, date: "1/11(æ—¥)", title: "ã‚·ãƒ¼ãƒ©ã‚¤ãƒ• P & ã‚¹ãƒ†ãƒ¼ã‚­", icon: "ğŸ¬",
                    summary: "ã‚·ãƒ¼ãƒ©ã‚¤ãƒ•ãƒ‘ãƒ¼ã‚¯ã§ã‚¤ãƒ«ã‚«ä½“é¨“ã€‚",
                    budgetEst: 350,
                    timeline: [
                        { time: "08:00", type: "bus", title: "é€è¿ãƒã‚¹ (Pickup)", desc: "æŒ‡å®šå ´æ‰€ã‹ã‚‰ã‚·ãƒ¼ãƒ©ã‚¤ãƒ•ãƒ‘ãƒ¼ã‚¯ã¸ã€‚", map: null },
                        { time: "09:00", type: "activity", title: "Sea Life Park", desc: "ãƒ‰ãƒ«ãƒ•ã‚£ãƒ³ & ã‚·ãƒ¥ãƒãƒ¼ã‚±ãƒ«ä½“é¨“ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Sea+Life+Park+Hawaii" },
                        { time: "15:00", type: "bus", title: "ãƒ¯ã‚¤ã‚­ã‚­æˆ»ã‚Š", desc: "é€è¿ãƒã‚¹ã§å¸°é‚„ã€‚", map: null },
                        { time: "16:00", type: "relax", title: "ãƒ›ãƒ†ãƒ«ä¼‘æ†©", desc: "ã‚·ãƒ£ãƒ¯ãƒ¼ã‚’æµ´ã³ã¦ç€æ›¿ãˆã€‚", map: null },
                        { time: "17:30", type: "walk", title: "å¾’æ­© (10åˆ†)", desc: "ã‚¯ãƒ’ã‚ªé€šã‚Šæ–¹é¢ã¸ã€‚", map: null },
                        { time: "18:00", type: "food", title: "Hy's Steak House", desc: "ã€ãƒ‡ã‚£ãƒŠãƒ¼ã€‘ã€äºˆç´„ç¢ºå®šã€‘ã‚¯ãƒ©ã‚·ãƒƒã‚¯ã‚¹ãƒ†ãƒ¼ã‚­ã€‚\nğŸ“ 808-922-5555\nğŸ‘” ç”·æ€§:è¥Ÿä»˜ãã‚·ãƒ£ãƒ„ãƒ»é©é´å¿…é ˆ\nğŸ‘” å¥³æ€§:ãƒ“ã‚¸ãƒã‚¹ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«", map: "https://www.google.com/maps/search/?api=1&query=Hy's+Steak+House+Waikiki", reserved: true }
                    ]
                },
                {
                    id: 7, date: "1/12(æœˆ)", title: "ã‚¢ã‚µã‚¤ãƒ¼ & ãƒã‚¤ã‚¿ã‚¤", icon: "ğŸ¹",
                    summary: "å¸°å›½å‰ã¯ã‚†ã£ãŸã‚Šã€‚ã™ã¹ã¦å¾’æ­©åœå†…ã§Chillã€‚",
                    budgetEst: 80,
                    timeline: [
                        { time: "11:00", type: "walk", title: "å¾’æ­© (5åˆ†)", desc: "ãƒ“ãƒ¼ãƒã‚¦ã‚©ãƒ¼ã‚¯æ–¹é¢ã¸ã€‚", map: null },
                        { time: "11:10", type: "food", title: "Nalu Health Bar", desc: "ã€ãƒ©ãƒ³ãƒã€‘ã‚¢ã‚µã‚¤ãƒ¼ãƒœã‚¦ãƒ«ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Nalu+Health+Bar+%26+Cafe+Waikiki" },
                        { time: "14:00", type: "walk", title: "å¾’æ­© (3åˆ†)", desc: "ãŠéš£ã®ãƒ”ãƒ³ã‚¯ãƒ‘ãƒ¬ã‚¹ã¸ã€‚", map: null },
                        { time: "14:10", type: "food", title: "Mai Tai Bar", desc: "ã€ã‚«ãƒ•ã‚§/é…’ã€‘æµ·é¢¨ã®ä¸­ã§ãƒã‚¤ã‚¿ã‚¤ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Mai+Tai+Bar+Royal+Hawaiian" },
                        { time: "Night", type: "relax", title: "ãƒ•ãƒªãƒ¼ãƒ‡ã‚£ãƒŠãƒ¼", desc: "ãŠè…¹ã®ç©ºãå…·åˆã«åˆã‚ã›ã¦ã€‚", map: null }
                    ]
                },
                {
                    id: 8, date: "1/13(ç«)", title: "ãƒ“ãƒ¼ãƒæ•£æ­© & è‚‰", icon: "ğŸ–",
                    summary: "ã‚ªãƒ³ã‚¶ãƒ“ãƒ¼ãƒã®ã‚¹ãƒ†ãƒ¼ã‚­å°å±‹ã¸ã€‚",
                    budgetEst: 50,
                    timeline: [
                        { time: "11:00", type: "walk", title: "å¾’æ­© (10åˆ†)", desc: "ç ‚æµœã‚’æ­©ã„ã¦ãƒ•ã‚©ãƒ¼ãƒˆãƒ‡ãƒ©ãƒƒã‚·ãƒ¼æ–¹é¢ã¸ã€‚", map: null },
                        { time: "11:30", type: "food", title: "Steak Shack", desc: "ã€ãƒ©ãƒ³ãƒã€‘æµ·å°å±‹ã‚¹ãƒ†ãƒ¼ã‚­å¼å½“ã€‚ãã®å ´ã§æµ·ã‚’è¦‹ãªãŒã‚‰ã€‚", map: "https://www.google.com/maps/search/?api=1&query=Steak+Shack+Waikiki" },
                        { time: "PM", type: "shop", title: "ãƒ•ãƒªãƒ¼ / è²·ã„ç‰©", desc: "æœ€å¾Œã®ãŠåœŸç”£æ¢ã—ã€‚", map: null }
                    ]
                },
                {
                    id: 9, date: "1/14(æ°´)", title: "æœ€çµ‚æ—¥ãƒ‡ã‚£ãƒŠãƒ¼", icon: "ğŸ½ï¸",
                    summary: "æœ€å¾Œã®ç§»å‹•ã‚‚ãƒˆãƒ­ãƒªãƒ¼æ´»ç”¨ã€‚",
                    budgetEst: 150,
                    timeline: [
                        { time: "17:00", type: "trolley", title: "ãƒ”ãƒ³ã‚¯ãƒ©ã‚¤ãƒ³ (JCBç„¡æ–™)", desc: "ã‚¢ãƒ©ãƒ¢ã‚¢ãƒŠHå‰ã§ä¸‹è»Šã—ã€ãƒ›ãƒ†ãƒ«ã¸ç›´çµã€‚", map: null },
                        { time: "18:00", type: "food", title: "Signature Prime Steak", desc: "ã€ãƒ‡ã‚£ãƒŠãƒ¼ã€‘ã€äºˆç´„ç¢ºå®šã€‘36éšã‹ã‚‰ã®å¤œæ™¯ã€‚\nğŸ“ 808-949-3636\nğŸ‘” ã‚¹ãƒãƒ¼ãƒˆã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ï¼ˆã‚¿ãƒ³ã‚¯ãƒˆãƒƒãƒ—ãƒ»å¸½å­ä¸å¯ï¼‰", map: "https://www.google.com/maps/search/?api=1&query=The+Signature+Prime+Steak+%26+Seafood", reserved: true },
                        { time: "20:00", type: "walk", title: "å¾’æ­© / ãƒˆãƒ­ãƒªãƒ¼", desc: "ã‚¢ãƒ©ãƒ¢ã‚¢ãƒŠã‚»ãƒ³ã‚¿ãƒ¼çµŒç”±ã§ãƒˆãƒ­ãƒªãƒ¼ã€ã¾ãŸã¯æ­©ã„ã¦å¸°å®…ã€‚", map: null },
                        { time: "Night", type: "hotel", title: "ãƒ‘ãƒƒã‚­ãƒ³ã‚°", desc: "è·é€ ã‚Šã€‚", map: null }
                    ]
                },
                {
                    id: 10, date: "1/15(æœ¨)", title: "å¸°å›½", icon: "âœˆï¸",
                    summary: "ç©ºæ¸¯ã¸ã€‚",
                    budgetEst: 0,
                    timeline: [
                        { time: "08:00", type: "transport", title: "Uber/ã‚¿ã‚¯ã‚·ãƒ¼", desc: "ç©ºæ¸¯ã¸ç§»å‹•ï¼ˆè·ç‰©ãŒã‚ã‚‹ãŸã‚è»Šæ¨å¥¨ï¼‰ã€‚", map: null },
                        { time: "10:55", type: "transport", title: "JL791 å‡ºç™º", desc: "Aloha 'Oe!", map: null }
                    ]
                }
            ],
            packing: [
                { item: "ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ & eãƒã‚±ãƒƒãƒˆ", checked: false },
                { item: "JCBã‚«ãƒ¼ãƒ‰", checked: false, note: "ãƒ”ãƒ³ã‚¯ãƒ©ã‚¤ãƒ³ç„¡æ–™ä¹—è»Šã«å¿…é ˆ" },
                { item: "é‹è»¢å…è¨±è¨¼ & å›½éš›å…è¨±", checked: false, note: "Day7ã§å¿…é ˆ" },
                { item: "æ­©ãã‚„ã™ã„é´/ã‚µãƒ³ãƒ€ãƒ«", checked: false, note: "1æ™‚é–“æ­©ã‘ã‚‹é´" },
                { item: "æ—¥ç„¼ã‘æ­¢ã‚ & å¸½å­", checked: false, note: "æ•£æ­©ã®æ—¥å·®ã—å¯¾ç­–" },
                { item: "Holo Card (TheBus)", checked: false, note: "ãƒã‚¹åˆ©ç”¨æ™‚(ABCã‚¹ãƒˆã‚¢ã§è³¼å…¥å¯)" },
                { item: "ã‚¨ã‚³ãƒãƒƒã‚°", checked: false },
                { item: "ä¸Šç€/ãƒ‘ãƒ¼ã‚«ãƒ¼", checked: false, note: "å†·æˆ¿å¯¾ç­–" },
                { item: "è–¬", checked: false, note: "å¸¸å‚™è–¬ãƒ»é…”ã„æ­¢ã‚ç­‰" },
                { item: "SIMã‚«ãƒ¼ãƒ‰", checked: false, note: "ç¾åœ°ç”¨SIMã¾ãŸã¯eSIM" },
                { item: "iPad", checked: false },
                { item: "Fire TV Stick", checked: false, note: "ãƒ›ãƒ†ãƒ«TVç”¨" },
                { item: "ãƒ—ãƒ­ãƒ†ã‚¤ãƒ³", checked: false },
                { item: "ãŠé…’(è§’)", checked: false },
                { item: "æ°´ç€", checked: false },
                { item: "ã°ã‚“ãã†ã“ã†", checked: false },
                { item: "é´ä¸‹", checked: false, note: "ãƒ¦ãƒ‹ã‚¯ãƒ­ã§è³¼å…¥" },
                { item: "è™«é™¤ã‘", checked: false },
                { item: "ã‚·ã‚§ãƒ¼ã‚«ãƒ¼", checked: false, note: "ãƒ—ãƒ­ãƒ†ã‚¤ãƒ³ç”¨" }
            ]
        };

        const app = {
            state: { currentView: 'dashboard', selectedDay: 0 },
            init() { this.render(); this.initCharts(); this.fetchExchangeRate(); setTimeout(() => this.initQuickAddRadio(), 100); },
            navigate(view) {
                this.state.currentView = view;
                document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
                document.getElementById(`nav-${view}`).classList.add('active');
                window.scrollTo(0, 0);
                this.render();
                if (view === 'dashboard') {
                    setTimeout(() => this.initCharts(), 50);
                    this.fetchExchangeRate();
                    setTimeout(() => this.initQuickAddRadio(), 100);
                }
            },
            render() {
                const c = document.getElementById('app-content');
                c.innerHTML = '';
                if (this.state.currentView === 'dashboard') c.innerHTML = this.views.dashboard();
                else if (this.state.currentView === 'itinerary') c.innerHTML = this.views.itinerary();
                else if (this.state.currentView === 'restaurants') c.innerHTML = this.views.restaurants();
                else if (this.state.currentView === 'spots') c.innerHTML = this.views.spots();
                else if (this.state.currentView === 'packing') c.innerHTML = this.views.packing();
                else if (this.state.currentView === 'memo') c.innerHTML = this.views.memo();
            },
            views: {
                dashboard() {
                    const totalBudget = tripData.days.reduce((sum, d) => sum + d.budgetEst, 0);
                    const outbound = tripData.meta.flights.outbound;
                    const returnFlight = tripData.meta.flights.return;
                    return `
                        <div class="bg-white p-5 rounded-2xl shadow-sm border border-stone-100 mb-6">
                            <h3 class="font-bold text-stone-700 mb-4 flex items-center gap-2 text-sm"><span>ğŸ’±</span> ãƒ‰ãƒ«â†’å†† æ›ç®—</h3>
                            <div class="space-y-4">
                                <div class="flex gap-2">
                                    <div class="flex-1">
                                        <label class="text-xs text-stone-500 block mb-1">USDé‡‘é¡</label>
                                        <input type="number" id="usd-input" placeholder="0.00" class="w-full p-3 border border-stone-200 rounded-xl text-lg font-bold text-center" oninput="app.convertCurrency()">
                                    </div>
                                    <div class="flex-1">
                                        <label class="text-xs text-stone-500 block mb-1">JPYæ›ç®—</label>
                                        <div id="jpy-output" class="w-full p-3 bg-teal-50 border border-teal-200 rounded-xl text-lg font-bold text-center text-teal-700">Â¥0</div>
                                    </div>
                                </div>
                                <div class="flex gap-2">
                                    <button onclick="app.setPaymentType('cash')" id="btn-cash" class="flex-1 p-2 rounded-lg text-xs font-bold bg-green-500 text-white">ğŸ’µ ç¾é‡‘</button>
                                    <button onclick="app.setPaymentType('card')" id="btn-card" class="flex-1 p-2 rounded-lg text-xs font-bold bg-stone-200 text-stone-600">ğŸ’³ ã‚«ãƒ¼ãƒ‰ (+3%)</button>
                                </div>
                                <div class="bg-stone-50 p-2 rounded-lg text-center">
                                    <div class="text-xs text-stone-500 mb-1">é©ç”¨ãƒ¬ãƒ¼ãƒˆ</div>
                                    <div id="rate-info" class="text-sm font-bold text-stone-700">èª­è¾¼ä¸­...</div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-5 rounded-2xl shadow-sm border border-stone-100 mb-6">
                            <h3 class="font-bold text-stone-700 mb-4 flex items-center gap-2 text-sm"><span>ğŸ½ï¸</span> ã‚°ãƒ«ãƒ¡ã‚µã‚¤ãƒˆ</h3>
                            <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                                <a href="https://tabelog.com/hawaii/rstLst/" target="_blank" rel="noopener noreferrer" class="flex items-center justify-center gap-2 p-3 bg-orange-50 rounded-xl text-orange-600 text-xs font-bold hover:bg-orange-100 transition-colors">ğŸ´ é£Ÿã¹ãƒ­ã‚°</a>
                                <a href="https://www.yelp.com/search?find_loc=Honolulu%2C+HI" target="_blank" class="flex items-center justify-center gap-2 p-3 bg-red-50 rounded-xl text-red-600 text-xs font-bold hover:bg-red-100 transition-colors">â­ Yelp</a>
                                <a href="https://www.tripadvisor.com/Restaurants-g60982-Honolulu_Oahu_Hawaii.html" target="_blank" class="flex items-center justify-center gap-2 p-3 bg-green-50 rounded-xl text-green-600 text-xs font-bold hover:bg-green-100 transition-colors">ğŸ¦­ TripAdvisor</a>
                                <a href="https://www.allhawaii.jp/" target="_blank" class="flex items-center justify-center gap-2 p-3 bg-blue-50 rounded-xl text-blue-600 text-xs font-bold hover:bg-blue-100 transition-colors">ğŸŒŠ allhawaii</a>
                            </div>
                        </div>
                        <div class="bg-white p-5 rounded-2xl shadow-sm border border-stone-100 mb-6">
                            <h3 class="font-bold text-stone-700 mb-4 flex items-center gap-2 text-sm"><span>â•</span> ã‚¯ã‚¤ãƒƒã‚¯è¿½åŠ </h3>
                            <div class="space-y-3">
                                <div class="flex gap-2">
                                    <input type="text" id="quick-add-input" placeholder="ã‚¢ã‚¤ãƒ†ãƒ ã‚’å…¥åŠ›" class="flex-1 p-3 border border-stone-200 rounded-xl text-sm">
                                    <button onclick="app.quickAdd()" class="px-4 py-2 bg-teal-600 text-white rounded-xl text-sm font-bold">è¿½åŠ </button>
                                </div>
                                <div class="grid grid-cols-4 gap-2">
                                    <label class="flex items-center justify-center gap-1 p-2 rounded-lg cursor-pointer bg-orange-100 text-orange-700">
                                        <input type="radio" name="quick-add-type" value="gourmet" class="hidden" checked>
                                        <span class="text-xs font-bold">ğŸ½ï¸ ã‚°ãƒ«ãƒ¡</span>
                                    </label>
                                    <label class="flex items-center justify-center gap-1 p-2 rounded-lg cursor-pointer bg-stone-100 text-stone-600">
                                        <input type="radio" name="quick-add-type" value="spots" class="hidden">
                                        <span class="text-xs font-bold">ğŸï¸ ã‚¹ãƒãƒƒãƒˆ</span>
                                    </label>
                                    <label class="flex items-center justify-center gap-1 p-2 rounded-lg cursor-pointer bg-stone-100 text-stone-600">
                                        <input type="radio" name="quick-add-type" value="packing" class="hidden">
                                        <span class="text-xs font-bold">ğŸ’ æŒã¡ç‰©</span>
                                    </label>
                                    <label class="flex items-center justify-center gap-1 p-2 rounded-lg cursor-pointer bg-stone-100 text-stone-600">
                                        <input type="radio" name="quick-add-type" value="memo" class="hidden">
                                        <span class="text-xs font-bold">ğŸ“ ãƒ¡ãƒ¢</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="mb-6 bg-white p-5 rounded-2xl shadow-sm border border-stone-100">
                            <h2 class="text-xl font-bold text-teal-800 mb-2">Aloha! æ—…ã®æ¦‚è¦</h2>
                            <p class="text-stone-600 text-sm mb-4 leading-relaxed">${tripData.meta.theme}</p>
                            <div class="space-y-3">
                                <div class="bg-stone-50 p-4 rounded-xl flex items-center gap-3">
                                    <span class="text-2xl">ğŸ¨</span>
                                    <div><div class="font-bold text-stone-800 text-sm">${tripData.meta.hotel}</div><div class="text-xs text-teal-600">${tripData.meta.nights}æ³Šãƒ»æœé£Ÿä»˜ã</div></div>
                                </div>
                                <div class="bg-gradient-to-r from-blue-50 to-sky-50 p-4 rounded-xl flex items-center gap-3">
                                    <span class="text-2xl">ğŸ’°</span>
                                    <div><div class="font-bold text-stone-800 text-sm">ãƒˆãƒ¼ã‚¿ãƒ«äºˆç®—ç›®å®‰</div><div class="text-lg text-teal-600 font-bold">$${totalBudget}</div></div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-6 bg-white p-5 rounded-2xl shadow-sm border border-stone-100">
                            <h3 class="font-bold text-stone-700 mb-4 flex items-center gap-2 text-sm"><span>âœˆï¸</span> ãƒ•ãƒ©ã‚¤ãƒˆæƒ…å ±</h3>
                            <div class="space-y-4">
                                <div class="bg-blue-50 p-4 rounded-xl">
                                    <div class="text-xs font-bold text-blue-600 mb-2">å¾€è·¯ ${outbound.date}</div>
                                    ${outbound.legs.map(l => `<div class="flex items-center gap-2 text-sm mb-1"><span class="font-mono bg-white px-2 py-0.5 rounded text-xs">${l.flight}</span><span class="text-stone-600">${l.from} ${l.dep} â†’ ${l.to} ${l.arr}</span><span class="text-xs text-stone-400">${l.class}</span></div>`).join('')}
                                </div>
                                <div class="bg-orange-50 p-4 rounded-xl">
                                    <div class="text-xs font-bold text-orange-600 mb-2">å¾©è·¯ ${returnFlight.date}</div>
                                    ${returnFlight.legs.map(l => `<div class="flex items-center gap-2 text-sm mb-1"><span class="font-mono bg-white px-2 py-0.5 rounded text-xs">${l.flight}</span><span class="text-stone-600">${l.from} ${l.dep} â†’ ${l.to} ${l.arr}</span><span class="text-xs text-stone-400">${l.class}</span></div>`).join('')}
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-5 rounded-2xl shadow-sm border border-stone-100 mb-6">
                            <h3 class="font-bold text-stone-700 mb-4 flex items-center gap-2 text-sm"><span>ğŸ’°</span> æ—¥åˆ¥äºˆç®—ç›®å®‰ ($)</h3>
                            <div class="chart-wrapper"><canvas id="budgetChart"></canvas></div>
                        </div>
                    `;
                },
                itinerary() {
                    const tabs = tripData.days.map(d => `<button onclick="app.selectDay(${d.id})" class="flex items-center gap-2 px-3 py-2 rounded-lg text-left transition-all ${app.state.selectedDay === d.id ? 'bg-teal-600 text-white shadow-md' : 'bg-white text-stone-600 border border-stone-200 hover:bg-stone-50'}"><span class="text-lg">${d.icon}</span><div><div class="text-[10px] opacity-80">${d.date}</div><div class="text-xs font-bold">Day ${d.id}</div></div></button>`).join('');
                    const current = tripData.days.find(d => d.id === app.state.selectedDay);
                    const timeline = current.timeline.map(t => {
                        let icon = 'ğŸ“', color = 'bg-stone-100 text-stone-600';
                        if (t.type === 'food') { icon = 'ğŸ½ï¸'; color = 'bg-orange-50 text-orange-600'; }
                        if (t.type === 'activity') { icon = 'ğŸ¤¿'; color = 'bg-blue-50 text-blue-600'; }
                        if (t.type === 'shop') { icon = 'ğŸ›ï¸'; color = 'bg-pink-50 text-pink-600'; }
                        if (t.type === 'trolley') { icon = 'ğŸšŒ'; color = 'bg-pink-100 text-pink-600'; }
                        if (t.type === 'bus') { icon = 'ğŸšŒ'; color = 'bg-blue-100 text-blue-600'; }
                        if (t.type === 'walk') { icon = 'ğŸš¶'; color = 'bg-green-50 text-green-600'; }
                        if (t.type === 'transport') { icon = 'ğŸš•'; color = 'bg-gray-100 text-gray-600'; }

                        // Reserved badge
                        const reservedBadge = t.reserved ? `<span class="ml-2 px-2 py-0.5 bg-green-500 text-white text-[10px] font-bold rounded-full">âœ“ äºˆç´„æ¸ˆ</span>` : '';

                        // Ticket Logic
                        const ticketHtml = t.ticket ? `<div class="mt-3"><div class="text-[10px] font-bold text-stone-500 mb-1">TICKET</div><img src="${t.ticket}" class="w-full max-w-[200px] rounded-lg border border-stone-200 shadow-sm" alt="Ticket"></div>` : '';

                        return `<div class="relative pl-8 pb-8 border-l-2 border-stone-100 last:border-0"><div class="absolute -left-[17px] top-0 w-8 h-8 rounded-full ${color} flex items-center justify-center border-4 border-white shadow-sm text-sm z-10">${icon}</div><div class="bg-white p-4 rounded-xl border border-stone-100 shadow-sm"><div class="flex justify-between items-start mb-2"><h4 class="font-bold text-stone-800 text-sm">${t.title}${reservedBadge}</h4><span class="text-[10px] bg-stone-50 px-2 py-1 rounded text-stone-400">${t.time}</span></div><p class="text-xs text-stone-600 mb-2 whitespace-pre-line">${t.desc}</p>${t.map ? `<a href="${t.map}" target="_blank" class="inline-flex items-center text-xs text-teal-600 font-bold py-1 px-2 bg-teal-50 rounded hover:bg-teal-100 transition-colors">ğŸ“ Map</a>` : ''}${ticketHtml}</div></div>`;
                    }).join('');
                    return `<div class="mb-4"><h2 class="text-xl font-bold text-teal-800">Day ${current.id}: ${current.title}</h2><p class="text-stone-500 text-xs">${current.summary}</p></div><div class="grid grid-cols-5 gap-2 pb-4 mb-2">${tabs}</div><div class="bg-stone-50 p-5 rounded-2xl border border-stone-200"><div class="mt-2">${timeline}</div></div>`;
                },
                spots() {
                    const spots = tripData.days.flatMap(d => d.timeline.filter(t => ['activity', 'shop'].includes(t.type)).map(t => ({ ...t, day: d.id, date: d.date })));
                    const unique = spots.filter((v, i, a) => a.findIndex(v2 => v2.title === v.title) === i);
                    const customSpots = JSON.parse(localStorage.getItem('customSpots') || '[]');
                    const allSpots = [...unique, ...customSpots.map(s => ({ ...s, isCustom: true }))];
                    return `<h2 class="text-xl font-bold text-teal-800 mb-4">ğŸï¸ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ & ã‚·ãƒ§ãƒƒãƒ—</h2><div class="grid grid-cols-1 sm:grid-cols-2 gap-3">${allSpots.map((s, idx) => `<div class="bg-white p-4 rounded-xl shadow-sm border border-stone-100 ${s.isCustom ? 'border-l-4 border-l-blue-400' : ''}"><div class="flex justify-between mb-2"><span class="text-[10px] px-2 py-1 rounded-full ${s.isCustom ? 'bg-blue-100 text-blue-600' : 'bg-stone-100'} font-bold">${s.isCustom ? 'è¿½åŠ ã‚¹ãƒãƒƒãƒˆ' : `Day ${s.day} (${s.date})`}</span>${s.isCustom ? `<button onclick="app.removeCustomItem('spots', ${idx - unique.length})" class="text-red-400 hover:text-red-600 text-xs">âœ•</button>` : ''}</div><h4 class="font-bold text-stone-800 text-sm mb-1">${s.title}</h4><p class="text-xs text-stone-600 mb-2 whitespace-pre-line">${s.desc}</p>${s.map ? `<a href="${s.map}" target="_blank" class="text-teal-600 text-xs font-bold">Map â†—</a>` : ''}</div>`).join('')}</div>`;
                },
                restaurants() {
                    const foods = tripData.days.flatMap(d => d.timeline.filter(t => t.type === 'food').map(t => ({ ...t, day: d.id, date: d.date })));
                    const unique = foods.filter((v, i, a) => a.findIndex(v2 => v2.title === v.title) === i);
                    const customGourmet = JSON.parse(localStorage.getItem('customGourmet') || '[]');
                    const allFoods = [...unique, ...customGourmet.map(s => ({ ...s, isCustom: true }))];
                    return `<h2 class="text-xl font-bold text-teal-800 mb-4">ğŸ½ï¸ ã‚°ãƒ«ãƒ¡ä¸€è¦§</h2><div class="grid grid-cols-1 sm:grid-cols-2 gap-3">${allFoods.map((s, idx) => {
                        const reservedBadge = s.reserved ? `<span class="ml-2 px-2 py-0.5 bg-green-500 text-white text-[10px] font-bold rounded-full">âœ“ äºˆç´„æ¸ˆ</span>` : '';
                        return `<div class="bg-white p-4 rounded-xl shadow-sm border border-stone-100 ${s.reserved ? 'border-l-4 border-l-green-500' : s.isCustom ? 'border-l-4 border-l-orange-400' : ''}"><div class="flex justify-between mb-2"><span class="text-[10px] px-2 py-1 rounded-full ${s.isCustom ? 'bg-orange-100 text-orange-600' : 'bg-orange-100 text-orange-600'} font-bold">${s.isCustom ? 'è¿½åŠ ã‚°ãƒ«ãƒ¡' : `Day ${s.day} (${s.date})`}</span>${s.isCustom ? `<button onclick="app.removeCustomItem('gourmet', ${idx - unique.length})" class="text-red-400 hover:text-red-600 text-xs">âœ•</button>` : `<span class="text-[10px] text-stone-400">${s.time || ''}</span>`}</div><h4 class="font-bold text-stone-800 text-sm mb-1">${s.title}${reservedBadge}</h4><p class="text-xs text-stone-600 mb-2 whitespace-pre-line">${s.desc}</p>${s.map ? `<a href="${s.map}" target="_blank" class="text-teal-600 text-xs font-bold">Map â†—</a>` : ''}</div>`;
                    }).join('')}</div>`;
                },
                packing() {
                    const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                    const baseItems = app.getBasePackingItems();
                    const editMode = app.editMode || false;
                    return `
                        <div class="mb-4 flex gap-2">
                            <input type="text" id="new-packing-item" placeholder="æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿½åŠ " class="flex-1 p-3 border border-stone-200 rounded-xl text-sm">
                            <button onclick="app.addPackingItem()" class="px-4 py-2 bg-teal-600 text-white rounded-xl text-sm font-bold">è¿½åŠ </button>
                        </div>
                        <div class="mb-3 text-center">
                            <button onclick="app.toggleEditMode()" class="px-4 py-2 ${editMode ? 'bg-orange-500' : 'bg-stone-200'} ${editMode ? 'text-white' : 'text-stone-600'} rounded-xl text-xs font-bold">
                                ${editMode ? 'âœ“ å®Œäº†' : 'âœï¸ ä¸¦ã³æ›¿ãˆ'}
                            </button>
                        </div>
                        
                        ${customItems.length > 0 ? `
                        <div class="mb-4">
                            <h3 class="text-sm font-bold text-blue-600 mb-2 flex items-center gap-2">ğŸ“Œ è¿½åŠ ã‚¢ã‚¤ãƒ†ãƒ </h3>
                            <div class="flex flex-col gap-2">${customItems.map((i, x) => `
                                <div class="flex items-center gap-2 p-3 bg-blue-50 rounded-xl border border-blue-200">
                                    ${editMode ? `
                                        <div class="flex gap-1">
                                            <button onclick="app.moveCustomItem(${x}, -1)" class="w-10 h-10 flex items-center justify-center rounded-lg ${x === 0 ? 'bg-stone-100 text-stone-300' : 'bg-blue-100 text-blue-600'} text-lg font-bold" ${x === 0 ? 'disabled' : ''}>â†‘</button>
                                            <button onclick="app.moveCustomItem(${x}, 1)" class="w-10 h-10 flex items-center justify-center rounded-lg ${x === customItems.length - 1 ? 'bg-stone-100 text-stone-300' : 'bg-blue-100 text-blue-600'} text-lg font-bold" ${x === customItems.length - 1 ? 'disabled' : ''}>â†“</button>
                                        </div>
                                    ` : ''}
                                    <label class="flex items-center gap-3 flex-1 cursor-pointer">
                                        <input type="checkbox" ${i.checked ? 'checked' : ''} onchange="app.toggleCustomCheck(${x})" class="w-5 h-5 text-blue-600 rounded">
                                        <div class="flex-1 ${i.checked ? 'line-through text-stone-400' : ''} text-sm">${i.item}</div>
                                    </label>
                                    <button onclick="app.removeCustomItem2(${x})" class="text-red-400 hover:text-red-600 text-sm px-2">âœ•</button>
                                </div>
                            `).join('')}</div>
                        </div>
                        ` : ''}
                        
                        <div>
                            <h3 class="text-sm font-bold text-stone-600 mb-2 flex items-center gap-2">ğŸ“‹ åŸºæœ¬ã‚¢ã‚¤ãƒ†ãƒ </h3>
                            <div class="flex flex-col gap-2">${baseItems.map((i, x) => `
                                <div class="flex items-center gap-2 p-3 bg-white rounded-xl border border-stone-200">
                                    ${editMode ? `
                                        <div class="flex gap-1">
                                            <button onclick="app.moveBaseItem(${x}, -1)" class="w-10 h-10 flex items-center justify-center rounded-lg ${x === 0 ? 'bg-stone-100 text-stone-300' : 'bg-teal-100 text-teal-600'} text-lg font-bold" ${x === 0 ? 'disabled' : ''}>â†‘</button>
                                            <button onclick="app.moveBaseItem(${x}, 1)" class="w-10 h-10 flex items-center justify-center rounded-lg ${x === baseItems.length - 1 ? 'bg-stone-100 text-stone-300' : 'bg-teal-100 text-teal-600'} text-lg font-bold" ${x === baseItems.length - 1 ? 'disabled' : ''}>â†“</button>
                                        </div>
                                    ` : ''}
                                    <label class="flex items-center gap-3 flex-1 cursor-pointer">
                                        <input type="checkbox" ${i.checked ? 'checked' : ''} onchange="app.toggleBaseCheck(${x})" class="w-5 h-5 text-teal-600 rounded">
                                        <div class="flex-1 ${i.checked ? 'line-through text-stone-400' : ''} text-sm">${i.item}${i.note ? `<span class="block text-[10px] text-orange-500">${i.note}</span>` : ''}</div>
                                    </label>
                                </div>
                            `).join('')}</div>
                        </div>
                    `;
                },
                memo() {
                    const memos = JSON.parse(localStorage.getItem('customMemo') || '[]');
                    const editMode = app.memoEditMode || false;
                    return `
                        <h2 class="text-xl font-bold text-teal-800 mb-4">ğŸ“ ãƒ¡ãƒ¢</h2>
                        <div class="mb-4 flex gap-2">
                            <input type="text" id="new-memo-item" placeholder="æ–°ã—ã„ãƒ¡ãƒ¢ã‚’è¿½åŠ " class="flex-1 p-3 border border-stone-200 rounded-xl text-sm">
                            <button onclick="app.addMemo()" class="px-4 py-2 bg-teal-600 text-white rounded-xl text-sm font-bold">è¿½åŠ </button>
                        </div>
                        ${memos.length > 0 ? `
                        <div class="mb-3 text-center">
                            <button onclick="app.toggleMemoEditMode()" class="px-4 py-2 ${editMode ? 'bg-orange-500' : 'bg-stone-200'} ${editMode ? 'text-white' : 'text-stone-600'} rounded-xl text-xs font-bold">
                                ${editMode ? 'âœ“ å®Œäº†' : 'âœï¸ ä¸¦ã³æ›¿ãˆ'}
                            </button>
                        </div>` : ''}
                        <div class="flex flex-col gap-2">${memos.map((m, x) => `
                            <div class="flex items-center gap-2 p-3 bg-white rounded-xl border border-stone-200">
                                ${editMode ? `
                                    <div class="flex gap-1">
                                        <button onclick="app.moveMemo(${x}, -1)" class="w-10 h-10 flex items-center justify-center rounded-lg ${x === 0 ? 'bg-stone-100 text-stone-300' : 'bg-purple-100 text-purple-600'} text-lg font-bold" ${x === 0 ? 'disabled' : ''}>â†‘</button>
                                        <button onclick="app.moveMemo(${x}, 1)" class="w-10 h-10 flex items-center justify-center rounded-lg ${x === memos.length - 1 ? 'bg-stone-100 text-stone-300' : 'bg-purple-100 text-purple-600'} text-lg font-bold" ${x === memos.length - 1 ? 'disabled' : ''}>â†“</button>
                                    </div>
                                ` : ''}
                                <label class="flex items-center gap-3 flex-1 cursor-pointer">
                                    <input type="checkbox" ${m.checked ? 'checked' : ''} onchange="app.toggleMemoCheck(${x})" class="w-5 h-5 text-purple-600 rounded">
                                    <div class="flex-1 ${m.checked ? 'line-through text-stone-400' : ''} text-sm">${m.text}</div>
                                </label>
                                <button onclick="app.removeMemo(${x})" class="text-red-400 hover:text-red-600 text-sm px-2">âœ•</button>
                            </div>
                        `).join('')}</div>
                        ${memos.length === 0 ? '<p class="text-center text-stone-400 text-sm mt-8">ãƒ¡ãƒ¢ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“</p>' : ''}
                    `;
                }
            },
            selectDay(id) { this.state.selectedDay = id; this.render(); },
            getPackingItems() {
                const saved = localStorage.getItem('packingChecks');
                const checks = saved ? JSON.parse(saved) : {};
                const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                const baseItems = tripData.packing.map((item, idx) => ({
                    ...item,
                    checked: checks[item.item] !== undefined ? checks[item.item] : item.checked
                }));
                return [...baseItems, ...customItems];
            },
            getBasePackingItems() {
                const saved = localStorage.getItem('packingChecks');
                const checks = saved ? JSON.parse(saved) : {};
                const savedOrder = localStorage.getItem('basePackingOrder');
                let items = [...tripData.packing];

                // Apply saved order if exists
                if (savedOrder) {
                    const order = JSON.parse(savedOrder);
                    items = order.map(name => tripData.packing.find(i => i.item === name)).filter(Boolean);
                    // Add any new items that weren't in the saved order
                    tripData.packing.forEach(item => {
                        if (!order.includes(item.item)) items.push(item);
                    });
                }

                return items.map((item) => ({
                    ...item,
                    checked: checks[item.item] !== undefined ? checks[item.item] : item.checked
                }));
            },
            toggleCustomCheck(idx) {
                const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                customItems[idx].checked = !customItems[idx].checked;
                localStorage.setItem('customPackingItems', JSON.stringify(customItems));
                this.render();
            },
            toggleBaseCheck(idx) {
                const checks = JSON.parse(localStorage.getItem('packingChecks') || '{}');
                const baseItems = this.getBasePackingItems();
                const item = baseItems[idx];
                checks[item.item] = !item.checked;
                localStorage.setItem('packingChecks', JSON.stringify(checks));
                this.render();
            },
            moveCustomItem(idx, direction) {
                const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                const newIdx = idx + direction;
                if (newIdx < 0 || newIdx >= customItems.length) return;
                [customItems[idx], customItems[newIdx]] = [customItems[newIdx], customItems[idx]];
                localStorage.setItem('customPackingItems', JSON.stringify(customItems));
                this.render();
            },
            moveBaseItem(idx, direction) {
                const baseItems = this.getBasePackingItems();
                const newIdx = idx + direction;
                if (newIdx < 0 || newIdx >= baseItems.length) return;
                [baseItems[idx], baseItems[newIdx]] = [baseItems[newIdx], baseItems[idx]];
                // Save the new order
                const order = baseItems.map(i => i.item);
                localStorage.setItem('basePackingOrder', JSON.stringify(order));
                this.render();
            },
            removeCustomItem2(idx) {
                const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                customItems.splice(idx, 1);
                localStorage.setItem('customPackingItems', JSON.stringify(customItems));
                this.render();
            },
            toggleCheck(idx) {
                const items = this.getPackingItems();
                items[idx].checked = !items[idx].checked;
                const checks = JSON.parse(localStorage.getItem('packingChecks') || '{}');
                checks[items[idx].item] = items[idx].checked;
                localStorage.setItem('packingChecks', JSON.stringify(checks));
                if (items[idx].custom) {
                    const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                    const customIdx = idx - tripData.packing.length;
                    customItems[customIdx].checked = items[idx].checked;
                    localStorage.setItem('customPackingItems', JSON.stringify(customItems));
                }
                this.render();
            },
            addPackingItem() {
                const input = document.getElementById('new-packing-item');
                if (!input || !input.value.trim()) return;
                const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                customItems.push({ item: input.value.trim(), checked: false, custom: true });
                localStorage.setItem('customPackingItems', JSON.stringify(customItems));
                input.value = '';
                this.render();
            },
            removePackingItem(idx) {
                const customIdx = idx - tripData.packing.length;
                const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                const removedItem = customItems[customIdx];
                customItems.splice(customIdx, 1);
                localStorage.setItem('customPackingItems', JSON.stringify(customItems));
                const checks = JSON.parse(localStorage.getItem('packingChecks') || '{}');
                delete checks[removedItem.item];
                localStorage.setItem('packingChecks', JSON.stringify(checks));
                this.render();
            },
            moveItem(idx, direction) {
                const items = this.getPackingItems();
                const newIdx = idx + direction;
                if (newIdx < 0 || newIdx >= items.length) return;
                const baseLen = tripData.packing.length;

                // Check if both items are in the same group
                const fromIsBase = idx < baseLen;
                const toIsBase = newIdx < baseLen;

                if (fromIsBase && toIsBase) {
                    // Both in base items - swap in tripData
                    [tripData.packing[idx], tripData.packing[newIdx]] = [tripData.packing[newIdx], tripData.packing[idx]];
                    this.render();
                } else if (!fromIsBase && !toIsBase) {
                    // Both in custom items - swap in localStorage
                    const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                    const ci = idx - baseLen;
                    const ni = newIdx - baseLen;
                    [customItems[ci], customItems[ni]] = [customItems[ni], customItems[ci]];
                    localStorage.setItem('customPackingItems', JSON.stringify(customItems));
                    this.render();
                }
                // If crossing boundary (base to custom or vice versa), do nothing - can't mix
            },
            editMode: false,
            toggleEditMode() {
                this.editMode = !this.editMode;
                this.render();
            },
            quickAdd() {
                const input = document.getElementById('quick-add-input');
                const type = document.querySelector('input[name="quick-add-type"]:checked')?.value || 'packing';
                if (!input || !input.value.trim()) return;
                const itemName = input.value.trim();

                if (type === 'packing') {
                    const customItems = JSON.parse(localStorage.getItem('customPackingItems') || '[]');
                    customItems.push({ item: itemName, checked: false, custom: true });
                    localStorage.setItem('customPackingItems', JSON.stringify(customItems));
                } else if (type === 'gourmet') {
                    const customGourmet = JSON.parse(localStorage.getItem('customGourmet') || '[]');
                    customGourmet.push({ title: itemName, desc: '', custom: true });
                    localStorage.setItem('customGourmet', JSON.stringify(customGourmet));
                } else if (type === 'spots') {
                    const customSpots = JSON.parse(localStorage.getItem('customSpots') || '[]');
                    customSpots.push({ title: itemName, desc: '', custom: true });
                    localStorage.setItem('customSpots', JSON.stringify(customSpots));
                } else if (type === 'memo') {
                    const memos = JSON.parse(localStorage.getItem('customMemo') || '[]');
                    memos.push({ text: itemName, checked: false });
                    localStorage.setItem('customMemo', JSON.stringify(memos));
                }
                input.value = '';
                const typeNames = { packing: 'æŒã¡ç‰©', gourmet: 'ã‚°ãƒ«ãƒ¡', spots: 'ã‚¹ãƒãƒƒãƒˆ', memo: 'ãƒ¡ãƒ¢' };
                alert(`ã€Œ${itemName}ã€ã‚’${typeNames[type]}ã«è¿½åŠ ã—ã¾ã—ãŸï¼`);
            },
            memoEditMode: false,
            toggleMemoEditMode() {
                this.memoEditMode = !this.memoEditMode;
                this.render();
            },
            addMemo() {
                const input = document.getElementById('new-memo-item');
                if (!input || !input.value.trim()) return;
                const memos = JSON.parse(localStorage.getItem('customMemo') || '[]');
                memos.push({ text: input.value.trim(), checked: false });
                localStorage.setItem('customMemo', JSON.stringify(memos));
                input.value = '';
                this.render();
            },
            removeMemo(idx) {
                const memos = JSON.parse(localStorage.getItem('customMemo') || '[]');
                memos.splice(idx, 1);
                localStorage.setItem('customMemo', JSON.stringify(memos));
                this.render();
            },
            toggleMemoCheck(idx) {
                const memos = JSON.parse(localStorage.getItem('customMemo') || '[]');
                memos[idx].checked = !memos[idx].checked;
                localStorage.setItem('customMemo', JSON.stringify(memos));
                this.render();
            },
            moveMemo(idx, direction) {
                const memos = JSON.parse(localStorage.getItem('customMemo') || '[]');
                const newIdx = idx + direction;
                if (newIdx < 0 || newIdx >= memos.length) return;
                [memos[idx], memos[newIdx]] = [memos[newIdx], memos[idx]];
                localStorage.setItem('customMemo', JSON.stringify(memos));
                this.render();
            },
            initQuickAddRadio() {
                document.querySelectorAll('input[name="quick-add-type"]').forEach(radio => {
                    radio.addEventListener('change', () => {
                        document.querySelectorAll('input[name="quick-add-type"]').forEach(r => {
                            const label = r.closest('label');
                            if (r.checked) {
                                if (r.value === 'gourmet') label.className = 'flex items-center justify-center gap-1 p-2 rounded-lg cursor-pointer bg-orange-100 text-orange-700';
                                else if (r.value === 'spots') label.className = 'flex items-center justify-center gap-1 p-2 rounded-lg cursor-pointer bg-blue-100 text-blue-700';
                                else if (r.value === 'memo') label.className = 'flex items-center justify-center gap-1 p-2 rounded-lg cursor-pointer bg-purple-100 text-purple-700';
                                else label.className = 'flex items-center justify-center gap-1 p-2 rounded-lg cursor-pointer bg-teal-100 text-teal-700';
                            } else {
                                label.className = 'flex items-center justify-center gap-1 p-2 rounded-lg cursor-pointer bg-stone-100 text-stone-600';
                            }
                        });
                    });
                });
            },
            removeCustomItem(type, idx) {
                if (type === 'gourmet') {
                    const items = JSON.parse(localStorage.getItem('customGourmet') || '[]');
                    items.splice(idx, 1);
                    localStorage.setItem('customGourmet', JSON.stringify(items));
                } else if (type === 'spots') {
                    const items = JSON.parse(localStorage.getItem('customSpots') || '[]');
                    items.splice(idx, 1);
                    localStorage.setItem('customSpots', JSON.stringify(items));
                }
                this.render();
            },
            exchangeRate: 157.0,
            paymentType: 'cash',
            async fetchExchangeRate() {
                try {
                    // Try frankfurter.app first (reliable, free, no key needed)
                    const res = await fetch('https://api.frankfurter.app/latest?from=USD&to=JPY');
                    const data = await res.json();
                    if (data.rates && data.rates.JPY) {
                        this.exchangeRate = data.rates.JPY;
                    }
                } catch (e) {
                    try {
                        // Fallback to open.er-api
                        const res2 = await fetch('https://open.er-api.com/v6/latest/USD');
                        const data2 = await res2.json();
                        if (data2.rates && data2.rates.JPY) {
                            this.exchangeRate = data2.rates.JPY;
                        }
                    } catch (e2) {
                        console.log('Using fallback rate: 157');
                    }
                }
                const rateInfo = document.getElementById('rate-info');
                if (rateInfo) {
                    rateInfo.textContent = `1 USD = Â¥${this.exchangeRate.toFixed(2)} (${new Date().toLocaleTimeString('ja-JP')})`;
                }
                this.convertCurrency();
            },
            convertCurrency() {
                const input = document.getElementById('usd-input');
                const output = document.getElementById('jpy-output');
                if (!input || !output) return;
                const usd = parseFloat(input.value) || 0;
                const fee = this.paymentType === 'card' ? 1.03 : 1;
                const jpy = Math.round(usd * this.exchangeRate * fee);
                output.textContent = `Â¥${jpy.toLocaleString()}`;
            },
            setPaymentType(type) {
                this.paymentType = type;
                const btnCash = document.getElementById('btn-cash');
                const btnCard = document.getElementById('btn-card');
                if (btnCash && btnCard) {
                    if (type === 'cash') {
                        btnCash.className = 'flex-1 p-2 rounded-lg text-xs font-bold bg-green-500 text-white';
                        btnCard.className = 'flex-1 p-2 rounded-lg text-xs font-bold bg-stone-200 text-stone-600';
                    } else {
                        btnCash.className = 'flex-1 p-2 rounded-lg text-xs font-bold bg-stone-200 text-stone-600';
                        btnCard.className = 'flex-1 p-2 rounded-lg text-xs font-bold bg-blue-500 text-white';
                    }
                }
                this.convertCurrency();
            },
            initCharts() {
                const ctx = document.getElementById('budgetChart');
                if (ctx) {
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: tripData.days.slice(0, 9).map(d => `Day ${d.id}`),
                            datasets: [{
                                data: tripData.days.slice(0, 9).map(d => d.budgetEst),
                                backgroundColor: '#ccfbf1',
                                borderColor: '#0d9488',
                                borderWidth: 1,
                                borderRadius: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                y: { beginAtZero: true },
                                x: { grid: { display: false } }
                            }
                        }
                    });
                }
            }
        };

        // Attach to window for global access
        window.app = app;
        window.tripData = tripData;

        // Initialize app when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => app.init());
        } else {
            app.init();
        }
    </script>
</body>

</html>